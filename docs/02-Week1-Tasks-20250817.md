# 1주차 개발 Task List

**문서명**: 전일 경제뉴스 다이제스트 - 1주차 개발 Task 목록  
**버전**: v1.0 (2025-08-17 KST)  
**기준 문서**: [01-Detail-Structure-20250817.md](./01-Detail-Structure-20250817.md)

## 개요

Java 8 + Spring Boot 2.7.x + Spring Batch 4.3.x + OpenAI API를 활용한 경제뉴스 자동 요약/해설 시스템의 1주차 핵심 개발 Task 목록입니다.

## 1주차 개발 목표

- Spring Boot + Batch 기본 프레임워크 구성
- 핵심 데이터 모델 및 파이프라인 구조 구현
- RSS 수집부터 AI 요약까지의 기본 플로우 완성
- 단위 테스트 환경 구축

---

## Task 목록

### **Task 1: Spring Boot 프로젝트 초기 설정 및 구조 생성** ✅ **완료**
**우선순위**: 최고  
**예상 소요시간**: 4시간  
**실제 소요시간**: 3.5시간

#### 상세 작업
- ✅ Maven 기반 Spring Boot 2.7.x 프로젝트 생성
- ✅ 패키지 구조 설계 및 생성
  ```
  com.yourco.econdigest
  ├─ batch/config/
  ├─ batch/steps/
  ├─ core/openai/
  ├─ core/extract/
  ├─ core/rank/
  ├─ core/discord/
  ├─ domain/
  └─ util/
  ```
- ✅ 기본 의존성 추가 (Spring Batch, PostgreSQL, Jackson, WebClient 등)
- ✅ 기본 Application.java 구성
- ✅ 유틸리티 클래스 작성 (TimeUtils, TextUtils)
- ✅ 기본 단위 테스트 작성

#### 완료 조건
- ✅ 프로젝트가 정상적으로 빌드되고 실행됨
- ✅ 패키지 구조가 설계 문서와 일치함
- ✅ 모든 단위 테스트 통과 (22개 테스트 모두 성공)

#### 구현 결과
- **생성된 파일**: pom.xml, EconDigestApplication.java, application.yml, TimeUtils.java, TextUtils.java
- **테스트 파일**: EconDigestApplicationTests.java, TimeUtilsTest.java, TextUtilsTest.java
- **빌드 상태**: 성공 (Maven clean compile test 모두 통과)

---

### **Task 2: PostgreSQL 데이터베이스 스키마 설계 및 Flyway 마이그레이션 파일 작성** ✅ **완료**
**우선순위**: 최고  
**예상 소요시간**: 3시간  
**실제 소요시간**: 4시간

#### 상세 작업
- ✅ Flyway 설정 및 의존성 추가
- ✅ DB 마이그레이션 파일 작성:
  - `V1__create_articles_table.sql` - 기사 정보 테이블 (PostgreSQL + H2 호환)
  - `V2__create_summaries_table.sql` - AI 요약/해설 테이블 (JSONB, 배열 지원)
  - `V3__create_daily_digest_table.sql` - 일일 다이제스트 테이블 (자동 업데이트 트리거)
  - `V4__create_dispatch_log_table.sql` - 발송 로그 테이블
  - `V5__create_full_text_search_indexes.sql` - 전문검색 인덱스 (pg_trgm 확장)
  - `V6__add_performance_indexes.sql` - 성능 최적화 인덱스 및 제약조건
- ✅ H2 테스트용 별도 마이그레이션 파일 작성 (src/test/resources/db/test-migration/)
- ✅ PostgreSQL 연결 설정 및 테스트 환경 구성

#### 완료 조건
- ✅ 마이그레이션이 정상 실행됨 (7개 마이그레이션 성공 적용)
- ✅ 모든 테이블이 설계 문서 스키마와 일치함
- ✅ 데이터베이스 스키마 검증 테스트 통과 (6개 테스트)
- ✅ Flyway 마이그레이션 테스트 통과 (2개 테스트)

#### 구현 결과
- **PostgreSQL 프로덕션 마이그레이션**: V1~V6 (TIMESTAMPTZ, BIGSERIAL, JSONB, 배열 지원)
- **H2 테스트 마이그레이션**: V1~V7 (H2 호환 데이터 타입, 샘플 데이터 포함)
- **데이터베이스 검증**: 테이블 구조, 외래키, 제약조건, 인덱스 모두 검증 완료
- **테스트 환경**: 별도 test-migration 디렉토리로 운영/테스트 환경 분리

---

### **Task 3: Spring Batch 기본 설정 및 ECON_DAILY_DIGEST Job 구조 구현** ✅ **완료**
**우선순위**: 최고  
**예상 소요시간**: 4시간  
**실제 소요시간**: 3시간

#### 상세 작업
- ✅ Spring Batch 설정 클래스 구현 (BatchConfiguration.java)
- ✅ `ECON_DAILY_DIGEST` Job 정의 및 Job Parameter Validator 구현
- ✅ Job Parameters 설정 (targetDate, maxArticles, dryRun, useLLM, forceRefresh, logLevel)
- ✅ 5개 Step의 기본 구조 정의:
  - S1_FETCH → S2_EXTRACT → S3_SUMMARIZE_AI → S4_RANK_COMPOSE → S5_DISPATCH
- ✅ Step 간 데이터 전달 구조 설계 (ExecutionContextUtil 활용)
- ✅ CommandLineRunner를 통한 Job 실행 환경 구성

#### 완료 조건
- ✅ Job이 정상적으로 등록되고 실행됨 (stub 구현으로)
- ✅ 모든 Step이 순차적으로 실행됨 (5개 Step 모두 완료)
- ✅ Job Parameter 검증이 정상 동작함
- ✅ Step 간 데이터 전달이 정상 동작함
- ✅ 모든 배치 관련 테스트 통과 (23개 테스트)

#### 구현 결과
- **Job 구성**: ECON_DAILY_DIGEST Job + 5개 Step (순차 실행)
- **파라미터 검증**: EconDigestJobParametersValidator (6개 파라미터 검증)
- **데이터 전달**: ExecutionContextUtil (Job/Step Context 활용)
- **테스트**: EconDailyDigestJobTest, EconDigestJobParametersValidatorTest, ExecutionContextUtilTest
- **실행 환경**: CommandLineRunner + JobLauncher (개발/테스트용)

---

### **Task 4: S1_FETCH Step 구현 - RSS 피드 수집 로직**
**우선순위**: 높음  
**예상 소요시간**: 6시간

#### 상세 작업
- RSS 파서 라이브러리 추가 및 설정
- `rss-sources.yml` 파일 기반 소스 목록 로드
- RSS 피드 수집 Reader 구현
- URL 중복 제거 로직 구현
- 타임아웃 및 재시도 메커니즘 구현
- 수집된 기사 정보 임시 저장 구조

#### 완료 조건
- 설정된 RSS 소스에서 기사 목록을 성공적으로 수집
- 중복 URL이 제거됨
- 네트워크 오류 시 적절한 재시도 동작

---

### **Task 5: S2_EXTRACT Step 구현 - 본문 추출 및 정제 로직**
**우선순위**: 높음  
**예상 소요시간**: 6시간

#### 상세 작업
- 웹 스크래핑 라이브러리 추가 (Jsoup 등)
- 기사 본문 추출 로직 구현
- 허용 범위 내 추출 정책 구현
- 문장 분할 및 Top-k 선별 로직
- 유사 중복 문장 제거 알고리즘
- 추출 실패 시 헤드라인 기반 폴백 처리
- articles 테이블 저장 로직

#### 완료 조건
- 기사 URL에서 본문을 추출하여 정제된 텍스트 생성
- 추출 실패 시 적절한 폴백 동작
- 정제된 데이터가 DB에 저장됨

---

### **Task 6: OpenAI API 클라이언트 기본 구현 (Structured Outputs 포함)**
**우선순위**: 높음  
**예상 소요시간**: 5시간

#### 상세 작업
- OpenAI API 클라이언트 구현 (WebClient 기반)
- Structured Outputs용 JSON 스키마 정의
- 요약 요청/응답 DTO 구현
- API 키 설정 및 보안 처리
- 레이트 리밋 및 재시도 로직 구현
- 토큰 사용량 추적 기능

#### 완료 조건
- OpenAI API 연동이 정상 동작
- JSON 스키마에 맞는 응답 파싱
- 에러 처리 및 재시도 메커니즘 동작

---

### **Task 7: S3_SUMMARIZE_AI Step 구현 - AI 요약/해설 생성 로직**
**우선순위**: 높음  
**예상 소요시간**: 6시간

#### 상세 작업
- System Prompt 및 User Prompt 템플릿 구현
- 2단계 라우팅 로직 (소형 모델 → 플래그십 모델)
- 요약/해설 결과 파싱 및 검증
- summaries 테이블 저장 로직
- LLM 호출 실패 시 재시도 로직
- 토큰 사용량 모니터링

#### 완료 조건
- 기사 텍스트에서 구조화된 요약/해설 생성
- 생성된 결과가 JSON 스키마를 준수
- 처리 결과가 DB에 저장됨

---

### **Task 8: 설정 파일 구성 (application.yml, rss-sources.yml, digest-template.yml)**
**우선순위**: 중간  
**예상 소요시간**: 3시간

#### 상세 작업
- `application.yml` 프로필별 설정 구성
- `rss-sources.yml` RSS 소스 및 가중치 설정
- `digest-template.yml` 디스코드 메시지 템플릿 설정
- 환경 변수 기반 민감 정보 처리
- 프로필별 설정 분리 (dev, staging, prod)

#### 완료 조건
- 모든 설정 파일이 올바르게 로드됨
- 환경별 설정이 적절히 분리됨

---

### **Task 9: 도메인 엔티티 및 리포지토리 계층 구현**
**우선순위**: 중간  
**예상 소요시간**: 4시간

#### 상세 작업
- JPA 엔티티 클래스 구현 (Article, Summary, DailyDigest, DispatchLog)
- Repository 인터페이스 구현
- 기본 CRUD 및 조회 메서드 구현
- 멱등성 처리를 위한 Upsert 로직
- 인덱스 최적화 고려사항 반영

#### 완료 조건
- 모든 도메인 엔티티가 정의됨
- 기본 데이터 접근 로직이 동작함

---

### **Task 10: 기본 단위 테스트 작성 및 테스트 환경 구성**
**우선순위**: 중간  
**예상 소요시간**: 4시간

#### 상세 작업
- JUnit 5 및 Mockito 설정
- 테스트 프로필 설정 (H2 인메모리 DB)
- 핵심 로직 단위 테스트 작성:
  - RSS 파싱 로직
  - 본문 추출 로직
  - OpenAI API 클라이언트
  - 중요도 산정 로직
- Mock 서버를 이용한 외부 API 테스트

#### 완료 조건
- 모든 핵심 컴포넌트의 단위 테스트 작성
- 테스트가 CI/CD 환경에서 실행 가능

---

## 우선순위 및 의존성

### 최우선 (Week 1-2일차)
1. Task 1: 프로젝트 초기 설정
2. Task 2: DB 스키마 설계
3. Task 3: Batch Job 구조

### 고우선 (Week 3-4일차)
4. Task 4: RSS 수집 구현
5. Task 6: OpenAI API 클라이언트

### 중우선 (Week 5-7일차)
6. Task 5: 본문 추출 구현
7. Task 7: AI 요약 구현
8. Task 9: 도메인 계층 구현

### 마무리 (Week 7일차)
9. Task 8: 설정 파일 구성
10. Task 10: 테스트 환경 구축

---

## 리스크 및 대응방안

### 기술적 리스크
- **OpenAI API 레이트 리밋**: 초기에는 소량 테스트로 시작, 점진적 확대
- **RSS 파싱 오류**: 다양한 소스에 대한 폴백 로직 구현
- **본문 추출 실패**: 헤드라인 기반 최소 요약으로 폴백

### 일정 리스크
- 각 Task별 버퍼 시간 20% 확보
- 핵심 기능 우선 구현, 부가 기능은 2주차로 연기 가능

---

## 1주차 완료 후 검증 기준

- [ ] 전체 배치 Job이 end-to-end로 실행됨
- [ ] RSS 수집부터 AI 요약까지 기본 플로우 동작
- [ ] 생성된 요약이 JSON 스키마를 준수
- [ ] 모든 단위 테스트가 통과
- [ ] 설정 파일 기반 환경 구성이 정상 동작

---

## 다음 주차 준비사항

1주차 완료 후 2주차에는 다음 작업들을 진행할 예정:
- S4_RANK_COMPOSE Step 구현 (중요도 산정 및 선별)
- S5_DISPATCH Step 구현 (디스코드 발송)
- Batch API 연동 구현
- Jenkins 파이프라인 구성
- 통합 테스트 및 성능 최적화